# ğŸ›¡ï¸ Cloud CLI Guard - Now Live for All Teams

Hey team!

We've deployed a new **safety system** to protect against accidental deletions and production incidents when using Azure and GitHub CLI.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“‹ What is it?

**Cloud CLI Guard** adds a **60-second safety cooldown** to destructive operations. Before any delete, purge, or dangerous command runs, it:

âœ… **Blocks** the command  
âœ… **Sends approval token** to this Teams channel  
âœ… **Waits 60 seconds** for you to reconsider  
âœ… **Requires token** from Teams to proceed (never shown in terminal)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ¤” Why?

â€¢ Prevent accidental resource deletions  
â€¢ Stop agents/LLMs from deleting things without approval  
â€¢ Protect against typos (e.g., deleting `prod-rg` instead of `dev-rg`)  
â€¢ Maintain audit trail of all dangerous operations

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸš« What gets blocked?

### ğŸ”´ Azure CLI (CRITICAL)
â€¢ `az group delete` â€” Entire resource groups  
â€¢ `az keyvault purge` â€” Permanent key vault deletion  
â€¢ `az vm stop/deallocate` â€” Production downtime  
â€¢ `az storage delete` â€” Data loss  
â€¢ All purge operations

### ğŸ”´ GitHub CLI (CRITICAL â€” No recovery!)
â€¢ `gh repo delete` â€” **REPO GONE FOREVER**  
â€¢ `gh release delete` â€” Release + assets deleted  
â€¢ `gh secret delete` â€” Credentials lost  
â€¢ `gh pr merge --admin` â€” Force merge

_Full list: Run `az --guard-matrix` or check the repo_

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## âš¡ Quick Install

**One command:**
```
curl -fsSL https://raw.githubusercontent.com/pitcherco/cloud-cli-guard/main/install-cloud-guard.sh | bash
```

Then reload your shell:
```
source ~/.bashrc  # or ~/.zshrc
```

_That's it! No manual config needed._

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“– How to use

### âœ… Normal commands (instant)
```
az account list     âœ… Works immediately
az group list       âœ… Works immediately  
gh repo list        âœ… Works immediately
gh pr view 123      âœ… Works immediately
```

### ğŸ›‘ Dangerous commands (blocked)
```
$ az group delete -n my-rg

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ’€ CRITICAL: Blocked          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

To approve:
1. Wait 60s
2. Check this Teams channel for token  
3. Run: az --approve <token>
```

**âš ï¸ Check this channel** â€” you'll see a message with the approval token!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ” Approving commands

1ï¸âƒ£ Try your command (it gets blocked)  
2ï¸âƒ£ Wait 60 seconds  
3ï¸âƒ£ Look in this Teams channel for the token  
4ï¸âƒ£ Run: `az --approve <token>` or `gh --approve <token>`

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ¤– For AI/Agents

If an AI assistant hits a safety gate, it will see instructions to ask you for the token. Just check this channel, give them the token, they'll execute: `az --approve <token>`

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸš¨ Emergency Break Glass

If you need to run multiple dangerous commands (e.g., cleanup, incident response):

```
az --break-glass --enable       # Request (blocked, sends token)
az --approve <token>            # Approve via Teams
az --break-glass --enable       # Now enabled for 1 hour

# Run your emergency commands...

az --break-glass --disable      # Disable when done
```

Break glass also requires Teams approval and auto-expires after 1 hour.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“š Quick Reference

| Command | Purpose |
|---------|---------|
| `az --guard-matrix` | Show all protected operations |
| `az --guard-status` | Check status and recent blocks |
| `az --approve <token>` | Approve blocked Azure command |
| `gh --approve <token>` | Approve blocked GitHub command |
| `az --break-glass --enable` | Request emergency bypass |

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“– Repo & Docs

â€¢ **Repository:** https://github.com/pitcherco/cloud-cli-guard  
â€¢ **Full docs:** See `CLOUD_CLI_GUARD_SETUP.md` in the repo  
â€¢ **Install script:** `install-cloud-guard.sh`

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## â“ FAQ

**Q: Does this slow down my normal workflow?**  
A: No! Only dangerous commands (delete, purge, etc.) are blocked. All read operations work instantly.

**Q: What if I need to delete something quickly?**  
A: Break glass mode allows bypassing after Teams approval, or just wait 60s + grab the token from this channel.

**Q: Will this break my existing scripts?**  
A: Only scripts that delete resources will be blocked. Non-destructive scripts work normally.

**Q: Can I see what's been blocked?**  
A: Yes! Check the audit: `cat ~/.azure/az-guard-audit.log` or ask in this channel.

**Q: What about GitHub CLI updates?**  
A: The guard survives `brew upgrade gh` â€” no reinstallation needed!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## âš ï¸ Action Required

**Please install this week:**

```
curl -fsSL https://raw.githubusercontent.com/pitcherco/cloud-cli-guard/main/install-cloud-guard.sh | bash && source ~/.bashrc
```

Questions? Check the repo or ask in this channel!

Thanks,  
Dustin

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

_Cloud CLI Guard â€” Protecting production, one 60-second cooldown at a time_ â±ï¸ğŸ›¡ï¸
